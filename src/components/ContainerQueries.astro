---
import CodeBlock from '@components/CodeBlock.astro';
import GridLayout from '@components/GridLayout.astro';
import TransitionHeader from '@components/TransitionHeader.astro';

const containerQueryCss = `.wrapper {
    container-name: card;
    container-type: inline-size;

    /** shorthand */
    container: card/inline-size;
}

.project-card {
    display: grid;
    grid-template-columns: 1fr;
}

@container card (min-width: 450px) {
    .project-card {
        grid-template-columns: 1fr 120px;
    }
}`;
---

<GridLayout>
    <div slot='info'>
        <TransitionHeader>Container Queries</TransitionHeader>
        <p>Container queries are essentially media queries, but for a component level.</p>
        <p>
            It allows us to query a component against the closest parent that has a defined containment, set via the
            container-type property
        </p>
        <CodeBlock code={containerQueryCss} lang='scss' />
    </div>

    <div slot='example'>
        <div class='wrapper'>
            <article class='project-card'>
                <header class='project-card__header'>
                    <time>26 Aug 2022</time>
                    <button>
                        <svg
                            width='100pt'
                            height='100pt'
                            version='1.1'
                            viewBox='0 0 100 100'
                            xmlns='http://www.w3.org/2000/svg'
                        >
                            <g>
                                <path
                                    d='m27.801 50c0 5.6875-4.6133 10.301-10.301 10.301s-10.301-4.6133-10.301-10.301 4.6133-10.301 10.301-10.301 10.301 4.6133 10.301 10.301'
                                ></path>
                                <path
                                    d='m60.301 50c0 5.6875-4.6133 10.301-10.301 10.301s-10.301-4.6133-10.301-10.301 4.6133-10.301 10.301-10.301 10.301 4.6133 10.301 10.301'
                                ></path>
                                <path
                                    d='m92.801 50c0 5.6875-4.6133 10.301-10.301 10.301s-10.301-4.6133-10.301-10.301 4.6133-10.301 10.301-10.301 10.301 4.6133 10.301 10.301'
                                ></path>
                            </g>
                        </svg>
                    </button>
                </header>
                <div class='project-card__body'>
                    <h3>Refactor</h3>
                    <p>Update components with container queries</p>
                    <div class='progress-wrapper'>
                        <p>Progress</p>
                        <div class='progress'>
                            <div class='progress__current'></div>
                        </div>
                        <p class=''>60%</p>
                    </div>
                </div>
                <footer class='project-card__footer'>
                    <div class='users-list'>
                        <div class='user'></div>
                        <div class='user'></div>
                        <div class='user'></div>
                    </div>
                    <p class='remaining'>2 days left</p>
                </footer>
            </article>
        </div>
        <div class='wrapper'>
            <article class='project-card'>
                <header class='project-card__header'>
                    <time>26 Aug 2022</time>
                    <button>
                        <svg
                            width='100pt'
                            height='100pt'
                            version='1.1'
                            viewBox='0 0 100 100'
                            xmlns='http://www.w3.org/2000/svg'
                        >
                            <g>
                                <path
                                    d='m27.801 50c0 5.6875-4.6133 10.301-10.301 10.301s-10.301-4.6133-10.301-10.301 4.6133-10.301 10.301-10.301 10.301 4.6133 10.301 10.301'
                                ></path>
                                <path
                                    d='m60.301 50c0 5.6875-4.6133 10.301-10.301 10.301s-10.301-4.6133-10.301-10.301 4.6133-10.301 10.301-10.301 10.301 4.6133 10.301 10.301'
                                ></path>
                                <path
                                    d='m92.801 50c0 5.6875-4.6133 10.301-10.301 10.301s-10.301-4.6133-10.301-10.301 4.6133-10.301 10.301-10.301 10.301 4.6133 10.301 10.301'
                                ></path>
                            </g>
                        </svg>
                    </button>
                </header>
                <div class='project-card__body'>
                    <h3>Refactor</h3>
                    <p>Update components with container queries</p>
                    <div class='progress-wrapper'>
                        <p>Progress</p>
                        <div class='progress'>
                            <div class='progress__current'></div>
                        </div>
                        <p class=''>60%</p>
                    </div>
                </div>
                <footer class='project-card__footer'>
                    <div class='users-list'>
                        <div class='user'></div>
                        <div class='user'></div>
                        <div class='user'></div>
                    </div>
                    <p class='remaining'>2 days left</p>
                </footer>
            </article>
        </div>
    </div>
</GridLayout>

<style>
    .project-card {
        display: flex;
        flex-direction: column;
        gap: var(--spacing-md);
        background-color: #fff;
        padding: var(--spacing-md);
        border-radius: var(--radius-md);
        border: var(--border-sm) solid #eaeaea;
        box-shadow: 0 3px 10px 0 rgba(0, 0, 0, 0.06);
    }

    .project-card button {
        inline-size: 32px;
        aspect-ratio: 1;
        appearance: none;
        border: 0;
        background: transparent;
        border-radius: 0;
        cursor: pointer;
        opacity: 0.25;
    }
    .project-card svg {
        width: 100%;
        height: 100%;
    }

    .project-card__header {
        display: flex;
        align-items: center;
    }
    .project-card__header time {
        font-size: 14px;
    }
    .project-card__header button {
        margin-left: auto;
    }

    .progress-wrapper {
        container: progress/inline-size;
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
        max-width: 400px;
    }
    .progress-wrapper p {
        font-size: 14px;
        margin-block-end: 0;
    }

    .progress {
        flex: 1;
        display: flex;
        height: 4px;
        background-color: rgba(0, 0, 0, 0.1);
        border-radius: var(--radius-md);
        overflow: hidden;
    }

    .progress__current {
        height: 4px;
        width: 50%;
        background-color: #528ef8;
    }

    .project-card__body > * + * {
        margin-top: 0.5rem;
    }
    .project-card__body > p {
        color: #585858;
        font-size: 14px;
    }

    .remaining {
        display: inline-flex;
        font-size: 14px;
        padding: 6px 12px;
        border-radius: var(--radius-full);
        background-color: rgba(239, 71, 111, 0.1);
    }

    .project-card__footer {
        display: flex;
        flex-wrap: wrap;
        align-items: center;
        gap: var(--spacing-md);
    }

    .users-list {
        display: flex;
    }

    .user {
        --size: 24px;
        width: var(--size);
        height: var(--size);
        background-color: #c7bbe2;
        border-radius: var(--radius-full);
        border: 2px solid #fff;
        opacity: 0.8;

        &:not(:first-child) {
            margin-left: -4px;
        }
        &:nth-child(2) {
            background-color: #bbe2c0;
        }
        &:nth-child(3) {
            background-color: #b7c2ff;
        }
    }

    @container progress (max-width: 200px) {
        .progress-wrapper p:first-child {
            display: none;
        }
    }

    @container card (max-width: 449px) {
        .progress-wrapper {
            border-top: 1px solid rgba(0, 0, 0, 0.25);
            padding-top: var(--spacing-md);
            margin-top: var(--spacing-md);
        }
    }
    @container card (min-width: 450px) {
        .project-card {
            display: grid;
            grid-template-columns: 1fr 120px;
        }

        .project-card__header {
            display: contents;
        }
        .project-card__header button {
            justify-self: end;
        }

        .project-card__body {
            grid-template-columns: 1fr 2fr;
            gap: 0 var(--spacing-md);
        }

        .project-card__footer {
            text-align: end;
        }

        .progress-wrapper {
            max-width: initial;
            grid-column: 2/3;
            grid-row: 1;
        }

        :where(h3, p) {
            grid-column: 1/2;
            margin: 0;
        }
    }
    @container card (min-width: 700px) {
        .project-card {
            grid-template-columns: 1fr 170px;
        }

        .project-card__body {
            display: grid;
        }

        .project-card__footer {
            align-items: start;
        }
    }

    .wrapper {
        container: card/inline-size;
        border: 1px dashed #222;
        max-width: 1000px;
        margin: 2rem auto 0;
        overflow: hidden;
        resize: horizontal;
        padding: 12px;
    }
</style>
